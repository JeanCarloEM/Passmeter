/* Passmeter
 * Javascript Object
 * 
 * @author     Jean Carlo de Elias Moreira | https://www.jeancarloem.com
 * @license    LGPL | https://www.gnu.org/licenses/lgpl.html
 * @copyright  © 2014 Jean Carlo EM
 * @git        https://github.com/JeanCarloEM/Passmeter
 * @site       https://opensource.jeancarloem.com/Passmeter 
 * @dependency xregexp | https://xregexp.com/ 
 */
"undefined"!=typeof Passmeter&&Passmeter||function(e,t,n){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null===this)throw new TypeError('"this" is null or not defined');var i=Object(this),a=i.length>>>0;if(0===a)return-1;var r=+t||0;if(Math.abs(r)===1/0&&(r=0),r>=a)return-1;for(n=Math.max(r>=0?r:a-Math.abs(r),0);n<a;){if(n in i&&i[n]===e)return n;n++}return-1}),"function"!=typeof e.getJSON&&(e.getJSON=function(e){return function(t,n){var i=new XMLHttpRequest;i.open("get",e,!0),i.responseType="json",i.onload=function(){var e=i.status;200===e?t(i.response):n(e)},i.send()}}),e.key_exists||(e.key_exists=function(e,t){return!(!t||t.constructor!==Array&&t.constructor!==Object)&&e in t}),t.LUR={AF:["Latin"],AM:["Ethiopic"],AR:["Arabic"],AY:["Latin"],AZ:["Arabic","Cyrillic","Latin"],BAL:["Latin"],BAN:["Balinese"],BBC:["Batak"],BE:["Cyrillic"],BG:["Cyrillic"],BI:["Latin"],BN:["Bengali"],BRH:["Latin"],BS:["Cyrillic","Latin"],BUG:["Buginese"],CA:["Latin"],CH:["Latin"],CS:["Latin"],CSB:["Latin"],DA:["Latin"],DE:["Latin"],DOI:["Takri"],DV:["Thaana"],DZ:["Tibetan"],EL:["Greek"],EN:["Latin"],ES:["Latin"],ET:["Latin"],FA:["Arabic"],FI:["Latin"],FIL:["Latin"],FJ:["Latin"],FO:["Latin"],FR:["Latin"],GA:["Latin"],GIL:["Latin"],GN:["Latin"],GSW:["Latin"],GV:["Latin"],HE:["Hebrew"],HI:["Devanagari"],HIF:["Devanagari","Latin"],HO:["Latin"],HOC:["Warang_citi"],HR:["Latin"],HT:["Latin"],HU:["Latin"],HY:["Armenian"],ID:["Latin"],II:["Latin"],INH:["Arabic","Latin"],IS:["Latin"],IT:["Latin"],JV:["Javanese"],KA:["Georgian"],KHA:["Bengali"],KK:["Arabic","Cyrillic"],KL:["Latin"],KM:["Khmer"],KV:["Old_permic"],KY:["Arabic","Cyrillic","Latin"],LA:["Latin"],LB:["Latin"],LEZ:["Caucasian_albanian"],LO:["Lao"],LT:["Latin"],LV:["Latin"],MAI:["Tirhuta"],MAK:["Buginese"],MEN:["Mende_kikakui"],MG:["Latin"],MH:["Latin"],MI:["Latin"],MK:["Cyrillic"],MN:["Cyrillic","Mongolian"],MNI:["Meetei_mayek"],MR:["Modi"],MS:["Arabic","Latin"],MT:["Latin"],MY:["Myanmar"],NA:["Latin"],NB:["Latin"],ND:["Latin"],NE:["Devanagari"],NIU:["Latin"],NL:["Latin"],NN:["Latin"],NY:["Latin"],OM:["Ethiopic"],PAP:["Latin"],PAU:["Latin"],PL:["Latin"],PS:["Arabic"],PT:["Latin"],QU:["Latin"],REJ:["Rejang"],RN:["Latin"],RO:["Latin"],RU:["Cyrillic"],RW:["Latin"],SA:["Devanagari","Grantha","Sharada","Siddham","Sinhala"],SAT:["Bengali","Devanagari","Ol_chiki","Oriya"],SD:["Khojki","Khudawadi"],SE:["Cyrillic"],SG:["Latin"],SI:["Sinhala"],SK:["Latin"],SL:["Latin"],SM:["Latin"],SN:["Latin"],SO:["Latin"],SQ:["Latin"],SR:["Cyrillic","Latin"],SS:["Latin"],ST:["Latin"],SU:["Sundanese"],SUS:["Arabic"],SV:["Latin"],SW:["Latin"],SWB:["Latin"],SYL:["Syloti_nagri"],TA:["Tamil"],TET:["Latin"],TG:["Arabic","Cyrillic","Latin"],TH:["Thai"],TI:["Ethiopic"],TK:["Arabic","Cyrillic","Latin"],TKL:["Latin"],TN:["Latin"],TO:["Latin"],TPI:["Latin"],TR:["Latin"],TVL:["Latin"],TY:["Latin"],TZM:["Latin","Tifinagh"],UDM:["Latin"],UG:["Latin"],UK:["Cyrillic"],UR:["Arabic"],UZ:["Arabic","Cyrillic","Latin"],VI:["Latin"],WO:["Latin"],YO:["Latin"],ZDJ:["Arabic"],ZH:["Bopomofo","Phags_pa"]},t.version=1,t.cfg={ws:{},uB:"",_a:8,mL:32,iDs:12,_RX:{}},t.meter=function(i,a){function r(e){return!0}function s(){return{scor:0,candidateScor:[],level:0,length:0,distincts:0,charTypes:0,pointsByType:0,lowerCaseLetters:0,upperCaseLetters:0,moreLetters:0,numbers:0,punctuation:0,simbols:0,words:[],wordLetters:0,dates:[],sequential:0,multipleScripts:!1,rules:{length:!1,distinct:!1,difCaseLetter:!1,noSequential:!1,noDate:!1,strength:!1,noWords:!1,specialChar:!1}}}function o(n,i){var a={letters:0,words:[]};if(i=t.getMacroLang(i),t.cfg.ws.length<=0||!i in t.cfg.ws)return t.getDic(i),null;if(!e.key_exists("en",t.cfg.ws)||!e.key_exists("hacking",t.cfg.ws))throw Error('Dicionários "en" e "hacking" não localizados');var r=["hacking","en"];e.key_exists(i,t.cfg.ws)&&r.push(i);for(var s,o=0;o<r.length;o++)if(e.key_exists(r[o],t.cfg.ws)&&(s=t.cfg.ws[r[o]]).length>0)for(var l,c=s.length;--c;)"string"==typeof(l=s[c])&&l.length>0&&(l=l.toLowerCase(),a.words.indexOf(l)<0&&n.indexOf(l)>=0&&(a.letters+=l.length,a.words.push(l)));return a}function l(e){return e=e.replace(/(.)(?=.*\1)/gi,"")}function c(e){if((e=e.toLowerCase()).length>=3){for(var t=-1,n=-1,i=-1,a=0,r=e.length;r--;)n=e.charCodeAt(r),-1===t||-1===i||(n!==t||i!==t-1&&i!==t+1&&i!==t)&&(n!==t+1||i!==t-1&&i!==t)&&(n!==t-1||i!==t+1&&i!==t)||a++,i=t,t=n;return a}return 0}function u(e){for(var t=0,n=e.length;n--;)t+=e[n]<<0;return t}function g(e,t,n){return XRegExp.replace(e,t,n)}function p(e){e=e.toUpperCase();for(var n="",i=0;i<t.LUR[e].length;++i)n+="\\p{"+t.LUR[e][i]+"}";return(n+="\\p{Common}").indexOf("\\p{Latin}")<0&&(n+="\\p{Latin}"),n}t.isLoaded||t.dependencias();var d={};return function(i,a){if(d=s(),"string"!=typeof i)return{approved:!1,passinfo:d};if(d.length=i.length,d.length>0){var L=l(i.substring(1).substring(0,i.length-2));if(d.distincts=l(i),d.distincts=null!==d.distincts&&d.distincts.length>0?d.distincts.length:0,d.scor=1,d.length>=9){d.scor+=1;var f=d.length-9>0?d.length-9:0;d.scor+=f>0?f/4:0}d.charTypes=0,d.pointsByType=0;var h=0;h+=1,d.lowerCaseLetters=L.match(t.cfg._RX.lowerLetters),d.pointsByType+=null!==d.lowerCaseLetters?1:0,d.charTypes+=null!==d.lowerCaseLetters?1:0,d.lowerCaseLetters=null!==d.lowerCaseLetters?d.lowerCaseLetters.length:0,L=g(L,t.cfg._RX.lowerLetters,""),h+=1,d.upperCaseLetters=L.match(t.cfg._RX.upperLetters),d.pointsByType+=null!==d.upperCaseLetters?1:0,d.charTypes+=null!==d.upperCaseLetters?1:0,d.upperCaseLetters=null!==d.upperCaseLetters?d.upperCaseLetters.length:0,L=g(L,t.cfg._RX.upperLetters,""),h+=1,d.moreLetters=L.match(t.cfg._RX.otherLetters),d.pointsByType+=null!==d.moreLetters?1:0,d.charTypes+=null!==d.moreLetters?1:0,d.moreLetters=null!==d.moreLetters?d.moreLetters.length:0,L=g(L,t.cfg._RX.otherLetters,""),h+=1.1,d.numbers=L.match(t.cfg._RX.numbers),d.pointsByType+=null!==d.numbers?1.1:0,d.charTypes+=null!==d.numbers?1:0,d.numbers=null!==d.numbers?d.numbers.length:0,L=g(L,t.cfg._RX.numbers,""),h+=1.1,d.punctuation=L.match(t.cfg._RX.punctuation),d.pointsByType+=null!==d.punctuation?1.1:0,d.charTypes+=null!==d.punctuation?1:0,d.punctuation=null!==d.punctuation?d.punctuation.length:0,L=g(L,t.cfg._RX.punctuation,""),h+=.9,d.simbols=L.match(t.cfg._RX.symbols),d.pointsByType+=null!==d.simbols?.9:0,d.charTypes+=null!==d.simbols?1:0,d.simbols=null!==d.simbols?d.simbols.length:0,h+=.8;var m=0,y=L.match(XRegExp("\\p{Sc}","gi"));m+=null!==y?1:0,y=null,m+=null!==(y=L.match(XRegExp("\\p{Sk}","gi")))?1:0,y=null,m+=null!==(y=L.match(XRegExp("\\p{Sm}","gi")))?1:0,y=null,m+=null!==(y=L.match(XRegExp("\\p{So}","gi")))?1:0,d.pointsByType+=m>0?2*m/10:0,h+=2;var w=p(a),S=new XRegExp("["+w+"]"),T=new XRegExp("[^"+w+"]");if(null!==i.match(S)&&null!==i.match(T)&&(d.pointsByType+=2,d.multipleScripts=!0),d.dates=i.match(t.cfg._RX.data),d.pointsByType-=null===d.dates?0:1+.5*d.dates.length,d.dates=null===d.dates?[]:d.dates,d.sequential=c(i),d.pointsByType-=d.sequential>0?1+.5*d.sequential:0,t.cfg.ws.length<=0||!e.key_exists(a,t.cfg.ws))t.getDic(a),n("Inexistência de dicionário. Considerando haver palavras na senha."),R={words:["Dicionário não baixado/existente."],letters:0};else var R=o(i);if(d.words=R.words,d.wordLetters=R.letters,d.pointsByType-=d.words.length>0?1+.15*d.words.length:0,d.pointsByType<1)d.scor=0;else{d.candidateScor=[],d.candidateScor.push(d.distincts*d.pointsByType/d.length*t.cfg._a),d.candidateScor[d.candidateScor.length-1]=Math.floor(d.candidateScor[d.candidateScor.length-1]>99?99:d.candidateScor[d.candidateScor.length-1]);var v=(100*(d.distincts/t.cfg.iDs>1?1:d.distincts/t.cfg.iDs)+100*(d.length/t.cfg.mL>1?1:d.length/t.cfg.mL))/2/100;d.candidateScor.push(Math.floor(d.pointsByType/h*v*100)),d.scor=Math.floor(u(d.candidateScor)/d.candidateScor.length)}d.scor>=60?d.level=4:d.scor>=25&&d.scor<60?d.level=3:d.scor>=20&&d.scor<25?d.level=2:d.scor>=10&&d.scor<20?d.level=1:d.level=0}var E=!0;return d.level>=3?d.rules.strength=!0:(d.rules.strength=!1,E=!1),d.numbers+d.punctuation+d.simbols>1?d.rules.specialChar=!0:(d.rules.specialChar=!1,E=!1),d.lowerCaseLetters>0&&d.upperCaseLetters>0||!r(a)?d.rules.difCaseLetter=!0:(d.rules.difCaseLetter=!1,E=!1),d.length>=9?d.rules.length=!0:(d.rules.length=!1,E=!1),d.distincts>=6?d.rules.distinct=!0:(d.rules.distinct=!1,E=!1),d.sequential?(d.rules.noSequential=!1,E=!1):d.rules.noSequential=!0,d.dates.length<=0?d.rules.noDate=!0:(d.rules.noDate=!1,E=!1),d.rules.noWords=!0,d.wordLetters>0&&d.words.length>0&&(d.length-d.wordLetters<3||d.wordLetters>=.6*d.length)&&(d.rules.noWords=!1,E=!1),{approved:E,passinfo:d}}(i,a=t.getMacroLang(a))},t.getLang=function(){if("string"!=typeof e.window.idioma){var t=e.window.navigator.userLanguage||e.window.navigator.language,i=e.jQuery("html").attr("lang"),a="string"==typeof t&&t.length>=2?t:"string"==typeof i&&i.length>=2?i:"pt-br";macro="undefined"==typeof macro||macro,!0===macro&&a.indexOf("-")>=0&&(a=(a=a.split("-"))[0]),n("Macro-idioma atual: "+a),e.window.idioma=a}return e.window.idioma},t.getMacroLang=function(e){return"string"==typeof e&&null!==e&&""!==e||(e=t.getLang()),e.indexOf("-")>=0&&(e=(e=e.split("-"))[0]),e=e.toLowerCase()},t.getDic=function(i){function a(i,a){if("string"!=typeof i||i.length<=12)throw Error("Impossível carregar dicionário: URL fornecida não é aceitável.");if(0===i.indexOf("//")&&(i=i.replace("//","https://")),i.match(/^(ht|f)tps?:\/\/[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s<>\#%"\,\{\}\\|\\\^\[\]`]+)?$/).length<=0)throw Error('Impossível carregar dicionário: URL inválida: "'+i+'".');(null===a||"string"!=typeof a||a.length<=0)&&(a=i.substring(i.lastIndexOf("/")+1),a=a.replace(".json","")),a=a.toLowerCase(),e.getJSON(i)(function(e){t.cfg.ws[a]=e,n("Dicionário ["+a+"] carregado! ... "+t.cfg.ws[a].length+" palavra(s).")},function(e){throw Error("Impossível carregar dicionário: ["+i+"'].")})}if("string"!=typeof(i=t.getMacroLang(i))||i.length<2)throw Error('PASSMETER :: HTML tag não possui atributo "lang" ou idioma solicitado em formato incorreto, impossibilitando reconhecer a linguagem');if(!t.cfg.uB.match(/^(ht|f)tps?:\/\/[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s<>\#%"\,\{\}\\|\\\^\[\]`]+)?$/))throw Error("PASSMETER :: URL inválida: ["+t.cfg.uB+"].");if(t.cfg.ws.length<=0||!e.key_exists(i,t.cfg.ws))try{a(t.cfg.uB+"/dic/"+i+".json",i)}catch(e){}if("hacking"!==i&&!e.key_exists("hacking",t.cfg.ws))try{a(t.cfg.uB+"/dic/hacking.json","hacking")}catch(e){}if("en"!==i&&!e.key_exists("en",t.cfg.ws))try{a(t.cfg.uB+"/dic/en.json","en")}catch(e){}},t.init=function(){function i(e){return"string"==typeof e&&(e=[e]),XRegExp.union(function(e){if(e.length>1){for(var t=[],n=0;n<e.length;++n)t.push(XRegExp("\\p{"+e[n]+"}"));return t}return[XRegExp("\\p{"+e+"}")]}(e),"g")}if(!t.isLoaded)if("function"==typeof XRegExp){if(t.cfg.uB.length<=10){var a=e.document.getElementsByTagName("script");if(null!==a)for(var r=!1,s=-1;!r&&++s<a.length;)null!==a[s].src.match(XRegExp("(Passmeter(.min)?.js)$","i"))&&(t.cfg.uB=XRegExp.replace(a[s].src,XRegExp("(.+)(Passmeter(.min)?.js)$","i"),"$1"),r=!0,n("URL path: "+a[s].src),n("URL base: "+t.cfg.uB))}t.cfg._RX={lowerLetters:i("Ll"),upperLetters:i("Lu"),otherLetters:i(["Lm","Lo","Lt"]),punctuation:i(["Mc","Me","Mn","Zl","Zp","Zs","Pc","Pd","Pe","Pf","Pi","Po","Ps"]),symbols:i(["Sc","Sk","Sm","So"]),numbers:i("Nd"),data:XRegExp(["(","(0[1-9]|[1-2][0-9]|3[01]).?(0[1-9]|1[0-2]).?((1[89]|20)?[0-9]{2})","|(0[1-9]|1[0-2]).?(0[1-9]|[1-2][0-9]|3[01]).?((1[89]|20)?[0-9]{2})","|((1[89]|20)?[0-9]{2}).?(0[1-9]|[1-2][0-9]|3[01]).?(0[1-9]|1[0-2])","|((1[89]|20)?[0-9]{2}).?(0[1-9]|1[0-2]).?(0[1-9]|[1-2][0-9]|3[01])","|(0[1-9]|1[0-2]).?(0[1-9]|[1-2][0-9]|3[01])","|(0[1-9]|[1-2][0-9]|3[01]).?(0[1-9]|1[0-2])","|((1[89]|20)?[0-9]{2}).?(0[1-9]|1[0-2])","|(0[1-9]|1[0-2]).?((1[89]|20)?[0-9]{2})",")"].join("\n"),"gix")},t.getDic(),t.isLoaded=!0}else e.window.setTimeout("Passmeter.init();",300)}}(this,function(e){return e.loadScript=function(e,t,n){void 0!==t&&null!==t&&""!==t||(t=!0);var i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.src=e,a.async=t,"function"==typeof n&&(a.onload=n),i.appendChild(a)},e.window.Passmeter=function(e,t){return Passmeter.meter(e,t)},Passmeter.isLoaded=!1,e.window.Passmeter.dependencias=function(){if(!e.window.Passmeter.isLoaded){"function"!=typeof XRegExp&&(console.log("PASSMETER :: XRegexp Ausente, carregando ..."),e.loadScript("https://cdnjs.cloudflare.com/ajax/libs/xregexp/2.0.0/xregexp-all-min.js",!1,function(){console.log("PASSMETER :: XRegexp Carregado!")}));try{e.window.Passmeter.init()}catch(t){e.window.setTimeout("console.log('PASSMETER :: Falha retentando...');window.Passmeter.dependencias();",300)}}},e.window.addEventListener?e.window.addEventListener("load",e.window.Passmeter.dependencias,!1):e.window.attachEvent&&e.window.attachEvent("onload",e.window.Passmeter.dependencias),"function"==typeof e.define&&(e.define.amd||e.define.amd)?e.define(["XRegExp"],function(){return e.window.Passmeter}):e.Passmeter=e.window.Passmeter,e.window.Passmeter}(this),function(e){console.log("PASSMETER :: "+e)});